name: Update aqua-checksums.json
description: Update aqua-checksums.json
inputs:
  working_directory:
    required: false
    description: |
      The working directory where `aqua update-checksum` is executed. If this input is not specified, the current working directory is used.
  prune:
    required: false
    default: "false"
    description: |
      If this input is `true`, `aqua update-checksum` is executed with `-prune` option.
      This option removes unused checksums from the checksum file.
      If this input is not specified, `false` is used.
  skip_push:
    required: false
    default: "false"
    description: |
      If this input is `true`, the action checks if the checksum file is up-to-date, but does not push a commit to update it.
      If this input is not specified, `false` is used.
      This input is useful when you want to check if the checksum file is up-to-date without pushing a commit.
  github_token:
    required: false
    default: ${{github.token}}
    description: |
      GitHub Access token.
  read_checksum_token:
    required: false
    default: "" # When this input is an empty string, it doesn't override `AQUA_GITHUB_TOKEN`.
    description: |
      This token overrides `AQUA_GITHUB_TOKEN` to executes `aqua update-checksum`. It must have `contents:read` permission about all repositories
      in tools managed by `aqua`. This input is useful to fetch checksum from private repositories.
  securefix_action_server_repository:
    required: false
    default: ""
    description: |
      The GitHub repository for the Securefix Action server.
      https://github.com/csm-actions/securefix-action
      If this is set, this action uses Securefix Action to update aqua-checksums.json.
  securefix_action_app_id:
    required: false
    default: ""
    description: |
      The GitHub App ID for the Securefix Action client.
  securefix_action_app_private_key:
    required: false
    default: ""
    description: |
      The GitHub App private key for the Securefix Action client.
outputs:
  checksum_file:
    description: Path to the checksum file that was found
  changed:
    description: Whether the checksum file has changed (true/false)
runs:
  using: node20
  main: dist/index.js
